---
title: "Sesame_EDA"
author: "Armelle Duston"
date: "2024-01-31"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Libaries
```{r}
library(tidyverse)
library(ggplot2)
library(GGally)

```


## Import Data
```{r}
just_scores <- read.csv('test_scores.csv')
subset_scores <- subset(just_scores, 
                        grepl('let', test_name) | 
                        grepl('form', test_name) | 
                        grepl('numb', test_name))

subset_scores <- subset_scores |> 
  mutate(which_test = case_when(grepl('let', test_name) ~ 'letters',
                                grepl('form', test_name) ~ 'forms',
                                grepl('numb', test_name) ~ 'numbers'))

Data <- read.csv('clean_df.csv')

Data <-  Data |> 
  mutate(encour = case_when(encour == 0 ~ 'No',
                            encour == 1 ~ 'Yes'))

# make categorical variables categorical 
Data$site <-  as.character(Data$site)
Data$sex <-  as.character(Data$sex)
Data$viewcat <-  as.character(Data$viewcat)
Data$setting <-  as.character(Data$setting)


glimpse(Data)
```


## Research Question 1: Does our programming improve childrenâ€™s knowledge of letters, numbers, and forms?

Comparing improvement (post-test - pre-test) based on viewcat (higher number = watched more)
```{r}

plot <- ggplot(Data, aes(x = viewcat, y = let_diff, fill = viewcat)) +
  geom_boxplot(show.legend=FALSE) +
  xlab("View Time (higher value=more)") + 
  ylab("Improvement") + 
  labs(title = "Letters") + 
  theme(axis.text=element_text(size=22),
        axis.title=element_text(size=30,face="bold"),
        title=element_text(size=25,face="bold"))
  ggsave("boxLetters.png", plot, width = 8, height = 6, dpi = 300)

plot <- ggplot(Data, aes(x = viewcat, y = numb_diff, fill = viewcat)) +
  geom_boxplot(show.legend=FALSE) +
  xlab("View Time") + 
  ylab("Improvement") + 
  labs(title = "Numbers") + 
  theme(axis.text=element_text(size=22),
        axis.title=element_text(size=30,face="bold"),
        title=element_text(size=25,face="bold"))
  ggsave("boxNumbers.png", plot, width = 8, height = 6, dpi = 300)

plot <- ggplot(Data, aes(x = viewcat, y = form_diff, fill = viewcat)) +
  geom_boxplot(show.legend=FALSE) +
  xlab("View Time") + 
  ylab("Improvement") + 
  labs(title = "Forms") + 
  theme(axis.text=element_text(size=22),
        axis.title=element_text(size=30,face="bold"),
        title=element_text(size=25,face="bold"))
  ggsave("boxForms.png", plot, width = 8, height = 6, dpi = 300)

```

Comparing improvement (post-test - pre-test) based on encouragement (1 = was encouraged)
```{r}

plot <- ggplot(Data, aes(x = encour, y = let_diff, fill = encour)) +
  geom_boxplot(show.legend=FALSE) +
  xlab("Encouragement") + 
  ylab("Improvement") + 
  labs(title = "Letters") + 
  theme(axis.text=element_text(size=22),
        axis.title=element_text(size=30,face="bold"),
        title=element_text(size=25,face="bold"))
  ggsave("boxLetters.png", plot, width = 8, height = 6, dpi = 300)

plot <- ggplot(Data, aes(x = encour, y = numb_diff, fill = encour)) +
  geom_boxplot(show.legend=FALSE) +
  xlab("Encouragement") + 
  ylab("Improvement") + 
  labs(title = "Numbers") + 
  theme(axis.text=element_text(size=22),
        axis.title=element_text(size=30,face="bold"),
        title=element_text(size=25,face="bold"))
  ggsave("boxNumbers.png", plot, width = 8, height = 6, dpi = 300)

plot <- ggplot(Data, aes(x = encour, y = form_diff, fill = encour)) +
  geom_boxplot(show.legend=FALSE) +
  xlab("Encouragement") + 
  ylab("Improvement") + 
  labs(title = "Forms") + 
  theme(axis.text=element_text(size=22),
        axis.title=element_text(size=30,face="bold"),
        title=element_text(size=25,face="bold"))
  ggsave("boxForms.png", plot, width = 8, height = 6, dpi = 300)

```



## Research Question 2: What, if any, area should we focus on for improvement?  E.g. are we better at teaching letters than we are at numbers?
```{r}
subset_scores$test_name <- factor(subset_scores$test_name,
    levels = c('preform','postform', 'prelet', 'postlet', 'prenumb', 'postnumb'),ordered = TRUE)


plot <- ggplot(subset_scores, aes(x=test_name, y=score, fill=which_test)) +
  geom_boxplot(show.legend=FALSE) +
  xlab("Which Test") + 
  ylab("Test Score") +
  labs(title = "Pre and Post Test Scores") +
  theme(axis.text=element_text(size=22),
        axis.title=element_text(size=30,face="bold"),
        axis.text.x = element_blank(),
        title=element_text(size=25,face="bold"))
  ggsave("PrePostBox.png", plot, width = 8, height = 6, dpi = 300)

plot <- ggplot(subset_scores, aes(x=which_test, y=score, fill=which_test)) +
  geom_boxplot(show.legend=FALSE) +
  xlab("Which Test") + 
  ylab("Test Score") +
  labs(title = "Average Test Scores") + 
  theme(axis.text=element_text(size=22),
        axis.title=element_text(size=30,face="bold"),
        title=element_text(size=25,face="bold"))
  ggsave("CategoriesBox.png", plot, width = 8, height = 6, dpi = 300)
```


## Investigate some possible confounders

Make long format dataframe for confounders
```{r}

long_Data <- subset_scores |>
  left_join(Data, by = 'ID')

```


Sex vs avg test score
```{r}
plot <- ggplot(long_Data, aes(x = which_test, y = score, fill = sex)) + 
  geom_boxplot(show.legend=FALSE) +
  xlab("Which Test") +
  ylab("Test Score") + 
  labs(title = "Average Test Scores by Sex") +
  theme(axis.text=element_text(size=22),
        axis.title=element_text(size=30,face="bold"),
        title=element_text(size=25,face="bold"))
  ggsave("GenderBox.png", plot, width = 8, height = 6, dpi = 300)
  

```

Site vs avg test score
```{r}
plot <- ggplot(long_Data, aes(x = which_test, y = score, fill = site)) + 
  geom_boxplot(show.legend=FALSE) +
  xlab("Which Test") +
  ylab("Test Score") + 
  labs(title = "Average Test Scores by Site") +
  theme(axis.text=element_text(size=22),
        axis.title=element_text(size=30,face="bold"),
        title=element_text(size=25,face="bold"))
  ggsave("SiteBox.png", plot, width = 8, height = 6, dpi = 300)

```

Age vs avg test score
```{r}
plot <- ggplot(long_Data, aes(x = age, y = score, col = which_test)) + 
  geom_point() +
  xlab("Age") +
  ylab("Test Score") + 
  labs(title = "Average Test scores by Age", col = "Which Test") +
  theme(axis.text=element_text(size=22),
        axis.title=element_text(size=30,face="bold"),
        title=element_text(size=25,face="bold"),
        legend.text =element_text(size = 25, face = "bold"))
  ggsave("AgeScatter.png", plot, width = 8, height = 6, dpi = 300)
```

Setting vs avg test score
```{r}

plot <- ggplot(long_Data, aes(x = which_test, y = score, fill = setting)) + 
  geom_boxplot(show.legend=FALSE) +
  xlab("Which Test") +
  ylab("Test Score") + 
  labs(title = "Test scores by Setting") +
  theme(axis.text=element_text(size=22),
        axis.title=element_text(size=30,face="bold"),
        title=element_text(size=25,face="bold"),
        legend.text =element_text(size = 25, face = "bold"))
  ggsave("SettingBox.png", plot, width = 8, height = 6, dpi = 300)

```











